(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d7ad796"],{"0d93":function(e,t,o){},2766:function(e,t,o){"use strict";o("0d93")},a927:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[e.isShowSelect?o("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.tableCol,(function(t,a){return["solt"==t.colType?o("el-table-column",{key:a+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align?t.align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(t.option,(function(t,i){return o("el-button",{key:i+"only",attrs:{type:"text",size:"small"},on:{click:function(e){return t.event(a.row)}}},[e._v(e._s(t.label))])}))}}],null,!0)}):o("el-table-column",{key:a+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align?t.align:"left"}})]}))],2),e.ispagination?o("div",{staticClass:"pagination-wrap"},[o("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[5,10,20,30,40,50,100],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.listQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)},i=[],r={name:"ELTable",props:{tableCol:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},ispagination:{type:Boolean,default:!0},isShowSelect:{type:Boolean,default:!1},listQuery:{type:Object,default:function(){return{page:1,page_size:10,total:0}}}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)}}},s=r,l=o("2877"),n=Object(l["a"])(s,a,i,!1,null,"f6412f26",null);t["a"]=n.exports},e01a:function(e,t,o){"use strict";var a=o("23e7"),i=o("83ab"),r=o("da84"),s=o("5135"),l=o("861d"),n=o("9bf2").f,c=o("e893"),d=r.Symbol;if(i&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof g?new d(e):void 0===e?d():d(e);return""===e&&(u[t]=!0),t};c(g,d);var m=g.prototype=d.prototype;m.constructor=g;var p=m.toString,_="Symbol(test)"==String(d("test")),f=/^Symbol\((.*)\)[^)]+$/;n(m,"description",{configurable:!0,get:function(){var e=l(this)?this.valueOf():this,t=p.call(e);if(s(u,e))return"";var o=_?t.slice(7,-1):t.replace(f,"$1");return""===o?void 0:o}}),a({global:!0,forced:!0},{Symbol:g})}},fe95:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"formDiv"},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[o("el-form-item",{attrs:{label:"工序名称"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listQuery.production_name,callback:function(t){e.$set(e.listQuery,"production_name",t)},expression:"listQuery.production_name"}},e._l(e.ProcessCodeNameList,(function(e,t){return o("el-option",{key:t+" search",attrs:{label:e.production_name,value:e.production_code}})})),1)],1),o("el-form-item",{attrs:{label:"工站"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listQuery.work_id,callback:function(t){e.$set(e.listQuery,"work_id",t)},expression:"listQuery.work_id"}},e._l(e.WorkCodeNameList,(function(e,t){return o("el-option",{key:t+" search",attrs:{label:e.work_name,value:e.work_id}})})),1)],1),o("el-form-item",{staticStyle:{"margin-left":"20px !important"}},[o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.searchBtn}},[e._v("查询")]),o("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)],1),o("el-card",{staticClass:"box-card mt20"},[o("div",{},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:e.addBtn}},[o("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1)],1),o("ELTable",{attrs:{tableCol:e.tableCol,tableData:e.tableData,listQuery:e.listQuery,ispagination:e.ispagination},on:{currentChange:e.currentChange,sizeChange:e.sizeChange}})],1)]),o("el-dialog",{attrs:{title:e.dialogTitle,width:"1000px",visible:e.dialogFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFlag=t}}},[o("el-form",{ref:"dialogFormRef",staticStyle:{padding:"0 60px 0 20px"},attrs:{model:e.dialogForm,rules:e.dialogFormRules,"label-width":"100px"}},[o("el-row",[o("p",{staticClass:"dialog-title"},[e._v("基本信息")]),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"工序编号",prop:"production_id"}},[o("el-input",{model:{value:e.dialogForm.production_id,callback:function(t){e.$set(e.dialogForm,"production_id",t)},expression:"dialogForm.production_id"}})],1),o("el-form-item",{attrs:{label:"工站",prop:"work_id"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.dialogForm.work_id,callback:function(t){e.$set(e.dialogForm,"work_id",t)},expression:"dialogForm.work_id"}},e._l(e.WorkCodeNameList,(function(e,t){return o("el-option",{key:t+" search",attrs:{label:e.work_name,value:e.work_id}})})),1)],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"工序名称",prop:"production_name"}},[o("el-input",{model:{value:e.dialogForm.production_name,callback:function(t){e.$set(e.dialogForm,"production_name",t)},expression:"dialogForm.production_name"}})],1),o("el-form-item",{attrs:{label:"上级工站",prop:"leader_work_id"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.dialogForm.leader_work_id,callback:function(t){e.$set(e.dialogForm,"leader_work_id",t)},expression:"dialogForm.leader_work_id"}},e._l(e.WorkCodeNameList,(function(e,t){return o("el-option",{key:t+" dialogForm",attrs:{label:e.work_name,value:e.work_id}})})),1)],1)],1)],1),o("el-form-item",{attrs:{label:"备注",prop:"description"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.dialogForm.description,callback:function(t){e.$set(e.dialogForm,"description",t)},expression:"dialogForm.description"}})],1),o("p",{staticClass:"dialog-title"},[e._v("工站允许加工物料明细")]),o("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.AddListRow()}}},[e._v("添加物料")]),o("el-table",{staticClass:"dialogTable",staticStyle:{width:"100%"},attrs:{data:e.dialogForm.response_datas,height:"240"}},[o("el-table-column",{attrs:{fixed:"left",label:"物料名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_code"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(o){return e.dialogMatterCodeChange(t.$index,t.row)}},model:{value:t.row.matter_code,callback:function(o){e.$set(t.row,"matter_code",o)},expression:"scope.row.matter_code"}},e._l(e.NoPagePersonMatterData,(function(e,t){return o("el-option",{key:t+" search",attrs:{label:e.matter_name,value:e.matter_code}})})),1)],1)]}}])}),o("el-table-column",{attrs:{label:"规格型号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",{attrs:{prop:"response_datas."+t.$index+".rule"}},[o("span",[e._v(e._s(t.row.rule))])])]}}])}),o("el-table-column",{attrs:{label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_category"}},[o("span",[e._v(e._s(t.row.matter_category))])])]}}])}),o("el-table-column",{attrs:{label:"最大数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_usage"}},[o("span",[e._v(e._s(t.row.matter_usage))])])]}}])}),o("el-table-column",{attrs:{label:"安装数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",{attrs:{prop:"response_datas."+t.$index+".install_number",rules:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须为数值",trigger:"blur"},{type:"number",min:0,max:t.row.matter_usage,message:"数量范围0-"+t.row.matter_usage,trigger:"blur"}]}},[o("el-input",{model:{value:t.row.install_number,callback:function(o){e.$set(t.row,"install_number",e._n(o))},expression:"scope.row.install_number"}})],1)]}}])}),o("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form-item",[o("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(o){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogFlag=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.dialogSave}},[e._v("确 定")])],1)],1)],1)},i=[],r=o("1da1"),s=o("5530"),l=(o("96cf"),o("159b"),o("a4d3"),o("e01a"),o("a927")),n=o("fd03"),c=o("2f62"),d={name:"ProcessList",components:{ELTable:l["a"]},computed:Object(s["a"])({},Object(c["c"])(["WorkCodeNameList","ProcessCodeNameList","NoPagePersonMatterData"])),data:function(){return{listQuery:{production_name:"",work_id:"",page:1,page_size:10,total:0},listQueryBase:{production_name:"",work_id:"",page:1,page_size:10,total:0},ispagination:!0,dialogTitle:"",dialogFlag:!1,dialogForm:{production_code:"",production_id:"",production_name:"",work_id:"",leader_work_id:"",description:"",response_datas:[{process_matter_deal_code:"",matter_code:"",rule:"--",matter_category:"--",matter_usage:"--",install_number:""}]},dialogFormBase:{production_code:"",production_id:"",production_name:"",work_id:"",leader_work_id:"",description:"",response_datas:[{process_matter_deal_code:"",matter_code:"",rule:"--",matter_category:"--",matter_usage:"--",install_number:""}]},dialogFormRules:{production_id:[{required:!0,message:"请输入工序编号",trigger:"blur"}],production_name:[{required:!0,message:"请输入工序名称",trigger:"blur"}],work_id:[{required:!0,message:"请选择工站",trigger:"change"}]},tableCol:[{label:"工序内码",field:"production_code",align:"center"},{label:"工序编号",field:"production_id",align:"center"},{label:"工序名称",field:"production_name",align:"center"},{label:"工站",field:"work_name",align:"center"},{label:"上级工站",field:"leader_work_id",align:"center"},{label:"备注",field:"description",align:"center"},{label:"操作",colType:"solt",align:"center",option:[{label:"修改",event:this.colEditBtn},{label:"删除",event:this.colDeleteBtn}]}],BOMResponseDatas:[],tableData:[]}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["getLogisticWorkCodeName","getLogisticProcessNameCode","getLogisticNoPagePersonMatter"])),{},{getLogisticBOMProductList:function(){var e=this,t={product_name:"",rule:"",product_status:"",page:1,page_size:10,total:0};n["a"].getLogisticBOMProductList(t).then((function(t){console.log("产品结构 查询",t),0==t.code?e.BOMResponseDatas=t.data.data[0].response_datas:e.$message({message:t.message,type:"error"})}))},searchBtn:function(){this.listQuery.page=1,this.getLogisticProcessDeal(this.listQuery)},resetForm:function(){this.listQuery=JSON.parse(JSON.stringify(this.listQueryBase)),this.getLogisticProcessDeal(this.listQuery)},currentChange:function(e){this.listQuery.page=e,this.getLogisticProcessDeal(this.listQuery)},sizeChange:function(e){this.listQuery.page=1,this.listQuery.page_size=e,this.getLogisticProcessDeal(this.listQuery)},getLogisticProcessDeal:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n["a"].getLogisticProcessDeal(e).then((function(e){if(console.log("工序列表 查询",e),0==e.code){var o=e.data.data;o.forEach((function(e){t.WorkCodeNameList.forEach((function(t){e.work_id==t.work_id&&(e.work_name=t.work_name)}))})),t.tableData=o,t.listQuery.total=e.data.total}else t.$message({message:e.message,type:"error"})}));case 1:case"end":return o.stop()}}),o)})))()},postLogisticProcessDeal:function(e){var t=this;n["a"].postLogisticProcessDeal(e).then((function(e){console.log("工序列表 新增",e),0==e.code?(t.dialogFlag=!1,t.getLogisticProcessDeal(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},addBtn:function(){var e=this;this.dialogTitle="新增工序",this.dialogFlag=!0,this.$nextTick((function(){e.$refs.dialogFormRef.clearValidate()})),this.dialogForm=JSON.parse(JSON.stringify(this.dialogFormBase))},AddListRow:function(){this.dialogForm.response_datas.push({process_matter_deal_code:"",matter_code:"",rule:"",matter_category:"",matter_usage:"",install_number:""})},dialogMatterCodeChange:function(e,t){this.BOMResponseDatas.forEach((function(e,o){t.matter_code==e.bom_matter_code&&(t.rule=e.rule,t.matter_category=e.matter_category,t.matter_usage=e.matter_usage)}))},colEditBtn:function(e){var t=this;console.log(e),this.dialogTitle="修改工序",this.dialogFlag=!0,this.$nextTick((function(){t.$refs.dialogFormRef.clearValidate()})),console.log("this.BOMResponseDatas",this.BOMResponseDatas),e.response_datas.forEach((function(e){t.BOMResponseDatas.forEach((function(t){e.matter_code==t.bom_matter_code&&(e.rule=t.rule,e.matter_category=t.matter_category,e.matter_usage=t.matter_usage)}))})),this.dialogForm={production_code:e.production_code,production_id:e.production_id,production_name:e.production_name,work_id:e.work_id,code_count:e.code_count,leader_work_id:e.leader_work_id,description:e.description,response_datas:e.response_datas}},getLogisticPutProcessDeal:function(e){var t=this;n["a"].getLogisticPutProcessDeal(e).then((function(e){console.log("工序列表 修改",e),0==e.code?(t.dialogFlag=!1,t.getLogisticProcessDeal(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},dialogSave:function(){var e=this;console.log(this.dialogTitle),this.$refs.dialogFormRef.validate((function(t){t?"新增工序"==e.dialogTitle?(console.log("新增工序",e.dialogForm),e.postLogisticProcessDeal(e.dialogForm)):"修改工序"==e.dialogTitle&&(console.log("修改工序",e.dialogForm),e.dialogForm.response_datas=JSON.stringify(e.dialogForm.response_datas),console.log("this.dialogForm.response_datas",e.dialogForm.response_datas),e.getLogisticPutProcessDeal(e.dialogForm)):e.$message({message:"请修改正确的数据格式！",type:"warning"})}))},getLogisticDeleteProcessDeal:function(e){var t=this;n["a"].getLogisticDeleteProcessDeal(e).then((function(e){console.log("工序列表 删除",e),0==e.code?(t.getLogisticProcessDeal(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},colDeleteBtn:function(e){var t=this;this.$confirm("确定执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.getLogisticDeleteProcessDeal({production_code:e.production_code})}))}}),mounted:function(){this.getLogisticWorkCodeName(),this.getLogisticProcessNameCode(),this.getLogisticNoPagePersonMatter(),this.getLogisticBOMProductList(),this.getLogisticProcessDeal(this.listQuery)}},u=d,g=(o("2766"),o("2877")),m=Object(g["a"])(u,a,i,!1,null,"352228aa",null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-4d7ad796.9f5f9bf8.js.map